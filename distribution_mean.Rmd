---
title: Test File
---

```{r}
# Load necessary libraries
library(readr)
library(ggplot2)
```

```{r}
# Read the TSV file into R
data <- read_tsv("/home/hongrui_liu/CAMH/American_Gut/subset_table.tsv",
                 skip = 1)

# Calculate mean and variance for each row
row_means <- apply(data[, -1], 1, mean)  # Assuming first column is row names
row_variances <- apply(data[, -1], 1, var)

# Create a data frame to store the means
mean_data <- data.frame(Bacteria = data[[1]], Mean = row_means)
```
```{r}
# Create a data frame to store the means and variances
mean_variance_data <- data.frame(
  Bacteria = data[[1]],       # Assuming the first column contains bacteria names
  Mean = row_means,
  Variance = row_variances
)
```
```{r}
# Plot the distribution of means
ggplot(mean_variance_data, aes(x = Mean)) +
  geom_histogram(binwidth = 0.005, fill = "blue", alpha = 0.7) +
  theme_minimal() +
  labs(title = "Distribution of Means", x = "Mean", y = "Frequency")
```

```{r}
# Plot Variance against Mean
ggplot(mean_variance_data, aes(x = Mean, y = Variance)) +
  geom_point(alpha = 0.6, color = "darkgreen") +
  theme_minimal() +
  labs(title = "Variance vs. Mean", x = "Mean", y = "Variance") +
  geom_smooth(method = "lm", se = FALSE, color = "red")  # Add a trend line
```